# Helm template
inject:
  enabled: true
  # Config contains the configuration files ca.json and defaults.json
  config:
    files:
      ca.json:
        root: /home/step/certs/root_ca.crt
        federateRoots: []
        crt: /home/step/certs/intermediate_ca.crt
        key: /home/step/secrets/intermediate_ca_key
        address: :9000
        dnsNames:
          - certificates.security.svc.cluster.local
        logger:
          format: json
        db:
          type: badgerv2
          dataSource: /home/step/db
        authority:
          enableAdmin: false
          provisioners:
            - {"type":"JWK","name":"cert-manager","key":{"use":"sig","kty":"EC","kid":"WO4hKL0PgL4hHXz9FgbgYjv4f42p1t5ARP0KsZmijKw","crv":"P-256","alg":"ES256","x":"PEEJIZuNrczswWlvHlhh6o8bNJB_jR7KxJRWIJcGqV4","y":"6gJi6WGinzhq0NrATnRRayfdcFYFlmMi-Ygq_L4vSB0"},"encryptedKey":"eyJhbGciOiJQQkVTMi1IUzI1NitBMTI4S1ciLCJjdHkiOiJqd2sranNvbiIsImVuYyI6IkEyNTZHQ00iLCJwMmMiOjYwMDAwMCwicDJzIjoiZzhpTWdpblBsM2hqd0oxLTF6X0gzQSJ9.YofcOI_KipgqDpaQ4OZ4zgO7ogsx3UN0xsjLHjZam0kZpuQhPbXF3g.qcd0PaccesyxQ523.jiB9VSmU4Zp1ED5JUFZcyAWMWlF8Y3aP30mUx6aFlTtGpu1wxT3VlRnhkN_Ye7AFpl133Nb76w480dhFjd-bMlwdPIx8U0t_ssOhPSoruUBGl6f_2Gz6cuAVFPAUGJ5uXUhpvsZ0Mu9qlkWgFq8WS4vYYiROh6HRBWvjPvm7UKxsgGpD-tmAXw7RH-McjVJ3Actqwp4hk1voX8xZUB-mXsDIfcccGF9o5owaYgbCQYTKHcLFk70Jq4SRItllpqafSKutsVfBmYqcqvYMtfABpyAPSbq5ZU1ls-0MBAcIrTD0zf8OrqhzyKxbkcRidba5Gb3AWx9n3J-otF-WCd0.85dcNYsR5vI68doZmqHPkA","options":{"x509":{},"ssh":{}}}
        tls:
          cipherSuites:
            - TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
            - TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
          minVersion: 1.2
          maxVersion: 1.3
          renegotiation: false

      defaults.json:
        ca-url: https://certificates.security.svc.cluster.local
        ca-config: /home/step/config/ca.json
        fingerprint: bfc1982a06915aac5436948e4e5624db1f7291ae4638492b983be9ff6d032a03
        root: /home/step/certs/root_ca.crt

  # Certificates contains the root and intermediate certificate and 
  # optionally the SSH host and user public keys
  certificates:
    # intermediate_ca contains the text of the intermediate CA Certificate
    intermediate_ca: |
      -----BEGIN CERTIFICATE-----
      MIIBvzCCAWagAwIBAgIQKGU0hW5VYtNLwhJT85F72DAKBggqhkjOPQQDAjAqMQ8w
      DQYDVQQKEwZIYXJib3IxFzAVBgNVBAMTDkhhcmJvciBSb290IENBMB4XDTI1MDcx
      MDE5MzMxNloXDTM1MDcwODE5MzMxNlowMjEPMA0GA1UEChMGSGFyYm9yMR8wHQYD
      VQQDExZIYXJib3IgSW50ZXJtZWRpYXRlIENBMFkwEwYHKoZIzj0CAQYIKoZIzj0D
      AQcDQgAEJ8ZFLC834sutwcjk2uJXHU+lW5P4LMgEAdwSpWyThf1Q3xqdNo5ZHNYw
      YQRh0FpUdi5F2grk/hGUuGBGFNPGcKNmMGQwDgYDVR0PAQH/BAQDAgEGMBIGA1Ud
      EwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFII5Zin3rA62QkyPBz6GycUgn1xnMB8G
      A1UdIwQYMBaAFOrLYxJl2Rzs2dD7XNHOXYDrl4cWMAoGCCqGSM49BAMCA0cAMEQC
      IHjEJ5sfUUcoHSEvg8+AH2t2/4HGwSbT4xWqdE+KdJ2bAiAC6x16lHKB5lBAjRYW
      Q4JGKnLAIxMmyeiKRmSMCpv7wQ==
      -----END CERTIFICATE-----
      
      
    # root_ca contains the text of the root CA Certificate
    root_ca: |
      -----BEGIN CERTIFICATE-----
      MIIBlzCCAT2gAwIBAgIQG4N2X+1Dz8U28IcY0wfBtjAKBggqhkjOPQQDAjAqMQ8w
      DQYDVQQKEwZIYXJib3IxFzAVBgNVBAMTDkhhcmJvciBSb290IENBMB4XDTI1MDcx
      MDE5MzMxNVoXDTM1MDcwODE5MzMxNVowKjEPMA0GA1UEChMGSGFyYm9yMRcwFQYD
      VQQDEw5IYXJib3IgUm9vdCBDQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABN17
      g2tsCN4Ysdd2b/uhOQtD+6uQxXGBQJ0BxA6Mb7PueeCVJueFkq6SoSvXvuHjjYqx
      ygDjrIrTef7Zpu/nsDajRTBDMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8ECDAG
      AQH/AgEBMB0GA1UdDgQWBBTqy2MSZdkc7NnQ+1zRzl2A65eHFjAKBggqhkjOPQQD
      AgNIADBFAiAz7ARfXd0PYLuMz/OYCzhfTT05dyJsfBEMHllMv+ZU3QIhALxSDoOO
      zp8FBEm85reH/to1pS9R5oSxBbrBv6YbDpn0
      -----END CERTIFICATE-----
      

  # Secrets contains the root and intermediate keys and optionally the SSH
  # private keys
  secrets:
    # ca_password contains the password used to encrypt x509.intermediate_ca_key, ssh.host_ca_key and ssh.user_ca_key
    # This value must be base64 encoded.
    ca_password: 
    provisioner_password: 

    x509:
      # intermediate_ca_key contains the contents of your encrypted intermediate CA key
      intermediate_ca_key: |
        -----BEGIN EC PRIVATE KEY-----
        Proc-Type: 4,ENCRYPTED
        DEK-Info: AES-256-CBC,0af13d6d869e378ff525e6ec4b68c394
        
        eOwozkh8dH6JSygWQ984Jmf9sWMWEZKHiSZ9TjfS6g8AYQEoAMnZe/ief2FfAb9/
        OFNlwVfAvugSdKGZA5q+ZY2zk7LkmVx0F4I+i4H4qKzcCNhrHyW2K4/JcbAiB4D3
        oS3VZUTY0F193CJSPAV6ZHvfZ0Gkj4SdTG/bHw+44nE=
        -----END EC PRIVATE KEY-----
        

      # root_ca_key contains the contents of your encrypted root CA key
      # Note that this value can be omitted without impacting the functionality of step-certificates
      # If supplied, this should be encrypted using a unique password that is not used for encrypting
      # the intermediate_ca_key, ssh.host_ca_key or ssh.user_ca_key.
      root_ca_key: |
        -----BEGIN EC PRIVATE KEY-----
        Proc-Type: 4,ENCRYPTED
        DEK-Info: AES-256-CBC,ac4edccee6b64144790a1745ad12cee8
        
        bpofQ7FtSGH2SKqwFwmYBoqA86OyhCfsaDCXC8BnRlE4h3OTp25PbZnfISGTtIis
        YCo0s+TRtTudpAqetbRIRNcDmTTWlhaT2mSM4UX+EkYABvrxXn6TaPHbGzijA3dj
        nHxvzEJxpAbKIV1SYNPQcp8cYTOgljYmr0ymv7dkHWg=
        -----END EC PRIVATE KEY-----
        
